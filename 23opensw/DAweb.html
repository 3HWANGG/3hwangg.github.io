<!DOCTYPE html>
<html>
<head>
<title>범람지도지도</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.20.1/ol.css" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.20.1/ol.js"></script>
</head>
<body>
<div id="vmap" style="width: 100%; height: 500px;"></div>

<script>
 

    var param = {
        name: '하천범람지도(지방하천)',
        serverUrl: 'http://www.safemap.go.kr/openApiService/wms/getLayerData.do?apikey=EALWNP4P-EALW-EALW-EALW-EALWNP4PP7',
        layername: 'A2SM_FLOODFOVRRISK2',
        styles: ''
    };

    var wmsLayer = new ol.layer.Image({
        source: new ol.source.ImageWMS({
            url: param.serverUrl,
            params: {
                'LAYERS': param.layername,
                'FORMAT': 'image/png',
                'TRANSPARENT': true
            },
            ratio: 1,
            serverType: 'geoserver'
        }),
        visible: true
    });

    var map = new ol.Map({
        target: 'vmap',
        layers: [
            new ol.layer.Tile({
                source: new ol.source.OSM()
            }),
            wmsLayer
        ],
        view: new ol.View({
            center: ol.proj.fromLonLat([126.9784, 37.5665]),
            zoom: 12
        })
    });
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;

            // 현재 위치에 마커를 표시합니다.
            var marker = new ol.layer.Vector({
                // 마커의 좌표
                latlng: ol.proj.fromLonLat([lon, lat]),
            
                // 마커에 사용할 아이콘
                icon: new ol.style.Icon({
                    src: './marker.png',
                    anchor: [1, 1],
                    size : [100,100]
                })
            });
            map.addLayer(marker);

            // 지도의 중심을 현재 위치로 이동합니다.
            map.getView().setCenter(ol.proj.fromLonLat([lon, lat]));
            map.getView().setZoom(16);
        });
    } else {
        alert('GeoLocation을 지원하지 않는 브라우저입니다.');
    }

</script>
</body>
</html>
